---
title: 继续测试
date: 2025-12-05
category: tech
tags: [个人开发, 日志]
description: 哈哈哈，看看与 Github Desktop 的联动
featured: true
author: Pennfly
---

# 思路对齐

## Q：

你呀，这次有些草率了，我还没有和你说清楚，你就自行修改了。先听我说：
1、对于这个应用，我希望有基础版和AI专家版，基础版就是逐渐完善的目前的版本；AI专家版，我还没有完整的想法，但是有几个基本方向，1）和基础版有一个开关机制，适当隔离，不能同时运行；2）在处理对象上，必须是完成了基础版处理之后的，最笨的办法就是下载再上传，显示你会有更好的办法，比如，在基础版处理的某个地方设置”提交AI专家处理“之类；3）即便是没有经过基础版处理，或者处理不完整，也能接受 AI专家版处理，只处理错别字、语气、人物关系等。和基础版的任务隔离，不干扰；4）最关键的，AI 专家版究竟处理哪些？我还没有想好，只想到一个错别字纠错，你明白吗。

请根据我这一段想法，将你的想法写到相应文档，同时重新梳理刚刚你做的事，该撤销的撤销。明白吗？

另外，1、对 AI 辅助，我想以 gemini 为主，预留其他厂商，2、AI 专家需要有单独的规则和提示词设定的交互窗口，也就是说，需要它修复什么？如何修复？并不是写死的，而是对话交互完成，3、在AI专家的规则设定时，不许它进行内容审核，你明白吗？

---

## A：

**总体目标**

- 用基础版自动化解决导入 Markdown 后的核心痛点：格式混乱、标点错乱、中英文空格、繁简转换、断行合并、引号统一
- 在基础能力稳定后，引入 AI 专家版处理更高阶问题（首要为错别字），逐步扩展到语法、风格、人物关系一致性等
- 全流程强调低误伤与可控性：先检测→计划→预览→应用→对比→导出

**版本与模式**

- 基础版与 AI 专家版为互斥模式，通过显式“模式开关”选择运行，不能同时运行
- 专家版优先作用于“基础版已处理后的内容”；但也允许在未完成基础处理时，仅执行高阶校对（如错别字），且不改变基础版的结构性修复
- 两版任务严格隔离：专家版不干扰基础版的格式/结构修复，输出独立报告或候选修复

**处理对象与串联**

- 基础版完成后在界面提供“提交到 AI 专家处理”入口；保底路径为“下载后再上传”
- 专家版输入可以是基础版当前文本快照或选定板块；输出为建议与候选修复，供用户在差异预览中选择应用

**专家版交互（规则与提示词）**

- 专家版提供独立“规则设定对话窗口”，以对话方式明确“修复什么？如何修复？”
- 能力分层：必选为错别字纠错；可选为重复词、重复标点、语法与风格、术语统一、人物关系一致性
- 提示词（Prompt）可模板化与参数化（术语表、领域词典、目标风格），可保存/加载

**供应商策略**

- 以 Gemini 为主供应商，预留 OpenAI/Azure OpenAI/Claude 等可插拔能力
- 后端抽象统一 Provider 接口，前端只关心模式与规则设定；具体调用由后端路由到对应 Provider
- 密钥仅从环境变量读取（如 `GEMINI_API_KEY`），不写入仓库；日志不输出明文密钥

**安全与合规**

- 专家版明确“禁止内容审核”，只执行文本修复与校对，不做内容审查或过滤
- 外部调用只发送必要片段与上下文，不携带用户隐私元数据；敏感信息不上传，必要时局部打码

**当前状态**

- 文档已对双模式架构、互斥开关、处理对象与入口设计、供应商策略与交互窗口进行了明确：
  - 统一计划：`docs/UNIFIED_PLAN.md`（AI 供应商策略与配置在 docs/UNIFIED_PLAN.md:65 起；规则设定与禁止内容审核在 docs/UNIFIED_PLAN.md:83、94）
  - README：`README.md`（AI 专家版规划与供应商说明在 README.md:21-33）
- 为避免跑偏，已撤销前端“AI 建议”临时按钮与调用，保留后端预备接口以备专家版落地：
  - 后端预备接口：`POST /api/ai/suggest`（server.js:197-209），基础规则示例（重复标点与重复词）：`src/domain/ai.js:1-24`
  - 前端界面保持基础版纯净，等待模式开关与专家版流程定稿

**下一步建议（最小落地）**

- 在设置面板增加“模式开关”（基础/专家），仅切换模式，不接通模型调用
- 设计“规则设定对话窗口”的字段与交互骨架（目标：错别字为必选，其它可选），先做静态占位
- 确定专家版的输入/输出协议（文本范围、候选修复结构、预览差异应用流程），与现有计划/预览组件对齐

如果以上理解与落笔符合你的意图，我可以继续实现“模式开关与规则设定窗口”的最小骨架，并保持所有调用与数据隔离，等待你确定专家版的具体处理清单后再接通 Gemini。