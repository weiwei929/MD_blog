---
title: LifeVideo·Neo 全景开发手记 (v2.0)
date: 2025-12-08
category: Project
tags: ['LifeVideoNeo', 'Architecture', '复盘']
description: 从零构建“数字记忆”的系统工程全景复盘，涵盖架构设计、技术选型与项目管理心法。
featured: true
author: Pennfly
---

# LifeVideo·Neo 全景开发手记：从零构建“数字记忆”的系统工程

**记录日期**: 2025-12-08
**版本**: v2.0 (全景珍藏版)
**记录人**: LifeVideo·Neo 架构团队

---

## 1. 缘起：重新定义“视频管理” (The Vision)

在这场开发之旅的起点，并非代码，而是对 [PRD文档] 的深度思考。面对用户硬盘中数以千计的“沉睡视频”，我们意识到：**这不仅仅是一个播放器，这是一个“记忆复活系统”。**

### 1.1 核心痛点 (Pain Points)
*   **“数字囤积症”**: 存了=没存。如果不被检索，数据就是电子垃圾。
*   **隐私红线**: 家庭视频包含极度隐私（孩子、家人），**“100% 本地化”** 是不可逾越的非功能性需求。
*   **“单人航母”**: 用户设备（如 GTX 1660）即便算力有限，也要承载起类云端的智能体验。

## 2. 架构设计：极简与解耦 (Architecture)

在 [architecture_design.md] 中，我们确立了 **"Electron + Python Sidecar"** 的双核架构。

### 2.1 为什么是双核？
*   **UI 层 (Electron/React)**: 负责“美”。利用 Web 技术栈实现流畅的拖拽、动效和可视化，保持界面永远不卡顿 (UI Thread Unblocked)。
*   **计算层 (Python/FastAPI)**: 负责“智”。利用 Python 庞大的 AI 生态 (PyTorch/Transformers)。
*   **通信桥梁**: 我们拒绝了复杂的 gRPC，选择了最朴素的 **HTTP RESTful API**。事实证明，这种松耦合让调试变得极其简单（浏览器就能测试接口）。

### 2.2 硬件适配策略
针对用户的 **GTX 1660 (6GB)** 显卡，我们实施了严格的资源预算：
*   **动态感知**: 启动时 `torch.cuda.is_available()` 自动判定。
*   **降级策略**: 显卡跑得动就上 CUDA，跑不动就退回 CPU (OpenVINO/Quantized)。决不崩溃。

## 3. 技术选型：本土化的胜利 (Tech Stack)

在 [tech_references.md] 中，我们经历了一场关于“国际化标准 vs 本土化最优”的深刻辩论。

### 3.1 拥抱阿里开源生态 (The Alibaba Ecosystem)
我们不仅是选了模型，更是选了生态：
*   **视觉 (Vision)**: 弃用 OpenAI CLIP，选用 **Chinese-CLIP (OFA-Sys)**。
    *   *理由*: 对中文语义（如“红衣女孩”）理解更深，且 Hugging Face 国内镜像下载极快。
*   **听觉 (Audio)**: 锁定 **FunASR** (待集成)。
    *   *理由*: 相比 Whisper，它对中文方言支持更好，推理速度快 3-5 倍。
*   **大脑 (LLM)**: 预留 **Qwen2.5 (0.5B)** 接口。
    *   *理由*: 极致轻量，能在老旧笔记本上跑通意图识别。

### 3.2 关键转折：从“黑盒”到“白盒”
*   **起初**: 我们使用 `ModelScope SDK`。虽然方便，但它像一个黑盒，带来了 Python 3.13 依赖地狱。
*   **破局**: 我们果断拆解黑盒，直接使用底层 `transformers` 库加载阿里模型。
    *   **得**: 获得了对推理逻辑的 100% 控制权（如解决 `NoneType` 报错）。
    *   **失**: 需要多写几十行代码。
    *   *结论*: **对于核心业务，控制权 > 便利性。**

## 4. 智能演进：从“功能”到“智慧” (Intelligence Evolution)

### 4.1 算法的三次跃迁
1.  **Level 1 (单帧匹配)**: 简单截取第 50% 帧。
    *   *缺陷*: 此路不通。视频是流动的，单帧代表不了整体。
2.  **Level 2 (三点采样)**: 引入 **Tri-Point (10%, 50%, 90%)** 采样 + Max-Score 机制。
    *   *突破*: 极大提升了搜索召回率。
3.  **Level 3 (元数据优先)**: 即使最好的 AI 也是昂贵的。
    *   *哲学*: **"Metadata-First"**。先榨干 ADS 流、文件名、Exif 的价值，再动用 AI。这是工程效率的巅峰。

## 5. 项目管理：克制的艺术 (Project Management)

如果说技术决定了下限，那么 **Scope Control (范围控制)** 决定了项目能否上线。

*   **P0 (生死线)**: 搜索必须准。这是 MVP 的核心。
*   **P1 (护城河)**: 来源溯源、智能分类。
*   **P2 (彩蛋)**: 自动剪辑、批量重命名。

我们严格遵循此路线图，抵制了“想做个自动剪辑”的诱惑，确保了此刻核心搜索功能的稳定落地。

---

**结语**:
LifeVideo·Neo 的诞生，不是堆砌代码，而是对**用户隐私的尊重**、对**硬件极限的挑战**以及对**本土化生态的深度理解**的共同结果。这份手记将作为项目的精神内核，指引未来的每一个版本。
